<!DOCTYPE html>
<html lang="en">
<!-- meta name="referrer" content="origin" -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
    <meta charset="UTF-8">
    <!-- meta name="referrer" content="origin" -->
    <title>thatsme.plus</title>
</head>
<body>

<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">


<style>

    /* std fonts */
    @import url('https://fonts.googleapis.com/css2?family=Didact+Gothic&family=IBM+Plex+Sans:wght@100;400;500;600&family=Open+Sans:wght@300;700&family=Rubik:wght@300;400;500&family=Source+Sans+Pro:wght@200;300;400;500;600;700;900&display=swap');
    /* header fonts */
    @import url('https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=IBM+Plex+Serif:wght@200;400;600&family=Rubik+Mono+One&display=swap');
    /* condensed fonts */
    @import url('https://fonts.googleapis.com/css2?family=Fira+Sans+Extra+Condensed:wght@100;400;500;600;700&family=Roboto+Condensed:wght@300;400;700&family=Barlow+Semi+Condensed:wght@100;400;500;600;700&&family=Open+Sans+Condensed:wght@300;700&display=swap');

    body {
        font-family      : "Helvetica Neue", Arial, Helvetica, sans-serif;
        background-color : #0075A2;
    }

    #thatsme-register-page {
        max-width: 550px;
        text-align: center;
        border-radius: 6px;
        background-color: #fff;
        padding: 4em;
        margin-left: auto;
        margin-right: auto; }

    .thatsme-logo-wrapper img { width: 60%; }
    .test-button {
        box-shadow: 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0,0,0,.12);
    }


</style>


<div id="thatsme-register-page">
<div class="thatsme-logo-wrapper">
    <img src="../img/thats-me-logo.svg">
</div>
 <h1>Create your self sovereign identity</h1>
<aurora-validation-indicator></aurora-validation-indicator>
<aurora-inputtext
        name="user_identity"
        aurora-name="user_identity"
        label="User ID"
        hint="Diese UserId ist nur fÃ¼r Dich einsehbar!"
        leading_icon="perm_identity"
        stack_label
        required
        fullwidth
>
</aurora-inputtext>

<aurora-inputtext
        name="user_password"
        aurora-name="user_password"
        label="Password"
        leading_icon="fingerprint"
        stack_label
        required
        fullwidth
>
</aurora-inputtext>

<aurora-button
        name="create"
        aurora-name="create"
        label="Create your self sovereign identity"
        leading_icon="verified_user"
        fullwidth
>
</aurora-button>

</div>

<div id="thatsme-scan-page" style="display: none;">
    <aurora-qrscanner onqrcode="console.log('QRcode: ', this.qrcode);" active="false"></aurora-qrscanner>
    <p id="status">Waiting...</p>
    <button id="stop" value="stop">stop</button>
</div>

<script type="module" src="/embedded"></script>

<script type="module">

    class ValidationMethodCanIuseID /*extends ValidationMethod */{
        errorID()             { return 'required'; }
        level()               { return  'change'; }
        priority()            { return '00'; }
        defaultErrorMessage() { return 'Geht nicht!'; }

        validate() {
            return false;
        }
    }

    window.vm = {};

    document.addEventListener('universe.thatsmeapp', () => {
        let app     = universe.thatsmeapp;
        let identity = universe.observe({
            useridentity: '',
            userpassword: '',
            create: function () {
                app.register(this.useridentity, this.userpassword);
            }
        });
        vm = new universe.aurora.ViewModel();
        vm.view = document.getElementById('thatsme-register-page');
        vm.model = identity;

        vm.addValidation('user_identity', new ValidationMethodCanIuseID());
    });

    document.addEventListener('universe.aurora', () => {
        //  thatsme interface
        let $qrscanner  = document.getElementsByTagName('aurora-qrscanner')[0];
        let $status     = document.getElementById('status');
        let $stop       = document.getElementById('stop');

        $qrscanner.addEventListener('qrcode',           (evt) => {
            $status.innerText = `QR: ${evt.detail}`;
            $qrscanner.stop();
        });
        $qrscanner.addEventListener('qrerror',          (evt) => $status.innerText = `ERROR: ${evt.detail}`);
        $qrscanner.addEventListener('qrvideoerror',    (evt) => $status.innerText = `VIDEO: ${evt.detail}`);

        $status.innerText = '';
        $stop.onclick = () => $qrscanner.stop();
    });

</script>
</body>
</html>
